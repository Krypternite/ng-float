!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=20)}([function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){var i=n(10),o="object"==typeof self&&self&&self.Object===Object&&self,r=i||o||Function("return this")();t.exports=r},function(t,e,n){var i=n(1).Symbol;t.exports=i},function(t,e){t.exports=$.ui.draggable},function(t,e){t.exports=$.ui.resizable},function(t,e){t.exports=angular},function(t,e,n){var i=n(8),o=n(0);t.exports=function(t,e,n){var r=!0,a=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return o(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),i(t,e,{leading:r,maxWait:e,trailing:a})}},function(t,e,n){},function(t,e,n){var i=n(0),o=n(9),r=n(12),a=Math.max,s=Math.min;t.exports=function(t,e,n){var u,l,f,c,h,p,m=0,d=!1,v=!1,g=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(e){var n=u,i=l;return u=l=void 0,m=e,c=t.apply(i,n)}function w(t){return m=t,h=setTimeout(x,e),d?y(t):c}function b(t){var n=t-p;return void 0===p||n>=e||n<0||v&&t-m>=f}function x(){var t=o();if(b(t))return k(t);h=setTimeout(x,function(t){var n=e-(t-p);return v?s(n,f-(t-m)):n}(t))}function k(t){return h=void 0,g&&u?y(t):(u=l=void 0,c)}function C(){var t=o(),n=b(t);if(u=arguments,l=this,p=t,n){if(void 0===h)return w(p);if(v)return clearTimeout(h),h=setTimeout(x,e),y(p)}return void 0===h&&(h=setTimeout(x,e)),c}return e=r(e)||0,i(n)&&(d=!!n.leading,f=(v="maxWait"in n)?a(r(n.maxWait)||0,e):f,g="trailing"in n?!!n.trailing:g),C.cancel=function(){void 0!==h&&clearTimeout(h),m=0,u=p=l=h=void 0},C.flush=function(){return void 0===h?c:k(o())},C}},function(t,e,n){var i=n(1);t.exports=function(){return i.Date.now()}},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(11))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i=n(0),o=n(13),r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(o(t))return NaN;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(r,"");var n=s.test(t);return n||u.test(t)?l(t.slice(2),n?2:8):a.test(t)?NaN:+t}},function(t,e,n){var i=n(14),o=n(17);t.exports=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==i(t)}},function(t,e,n){var i=n(2),o=n(15),r=n(16),a=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?o(t):r(t)}},function(t,e,n){var i=n(2),o=Object.prototype,r=o.hasOwnProperty,a=o.toString,s=i?i.toStringTag:void 0;t.exports=function(t){var e=r.call(t,s),n=t[s];try{t[s]=void 0;var i=!0}catch(t){}var o=a.call(t);return i&&(e?t[s]=n:delete t[s]),o}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var i=n(5),o=n.n(i),r=n(6),a=n.n(r);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var u=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.top=n,this.items=e,e.forEach((function(t){return t.row=i}))}var e,n,i;return e=t,(n=[{key:"addItem",value:function(t){this.items.push(t),t.row=this}},{key:"removeItem",value:function(t){var e=this.items.indexOf(t);t.row=null,this.items.splice(e,1)}},{key:"setTop",value:function(t){var e=this;this.top=t,this.items.forEach((function(t){return t.top=e.top}))}},{key:"getHeight",value:function(){return this.items.reduce((function(t,e){return Math.max(t,e.height)}),0)}},{key:"getOverlap",value:function(t,e){var n=0;return this.items.forEach((function(i){i.doesOverlap(t)&&(n=e?Math.max(n,t.top+t.height-i.top):Math.max(n,i.top+i.height-t.top))})),n}}])&&s(e.prototype,n),i&&s(e,i),t}();function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var p=function(){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];c(this,t);do{n.sort((function(t,e){return 1e4*(t.top-e.top)+t.left-e.left})),e=this.positionItems(n)}while(e);this.rows=this.itemsToRows(n)}var e,n,i;return e=t,(n=[{key:"positionItems",value:function(t){for(var e=!1,n=0;n<t.length;n++)for(var i=n+1;i<t.length;i++)t[n].doesOverlap(t[i])&&(t[n].top<=t[i].top?t[i].top=t[n].top+t[n].height:t[n].top>t[i].top&&(t[n].top=t[i].top+t[i].height),e=!0,console.warn(t[n],"".concat(n," overlaps ").concat(i),t[i]));return e}},{key:"itemsToRows",value:function(t){var e=this,n={};return t.forEach((function(t){t.top in n?n[t.top].push(t):n[t.top]=[t]})),Object.entries(n).map((function(t){var n=l(t,2),i=n[0],o=n[1];return new u(o,Number(i),e)})).sort((function(t,e){return t.top-e.top}))}},{key:"addItem",value:function(t){var e,n;for(e=0;e<this.rows.length;e++){if(!(this.rows[e].top<t.top)){this.rows[e].top===t.top&&(n=this.rows[e]);break}t.top+=this.rows[e].getOverlap(t,!1)}n&&!n.getOverlap(t,!0)?n.addItem(t):this.rows.splice(e,0,new u([t],t.top,this));for(var i=e+1;i<this.rows.length;i++)this.shiftRows(this.rows.slice(i),this.rows[i].getOverlap(t,!0))}},{key:"editItem",value:function(t,e){this.removeItem(t),this.addItem(Object.assign(t,e))}},{key:"removeItem",value:function(t){var e=t.row;e.removeItem(t),0===e.items.length&&this.rows.splice(this.rows.indexOf(e),1)}},{key:"shiftRows",value:function(t,e){t.forEach((function(t){return t.setTop(t.top+e)}))}},{key:"removeGaps",value:function(){if(0!==this.rows.length){0!==this.rows[0].top&&this.shiftRows(this.rows,-this.rows[0].top);for(var t=0,e=1;e<this.rows.length;e++){t=Math.max(t,this.rows[e-1].top+this.rows[e-1].getHeight());var n=this.rows[e].top-t;n>0&&this.shiftRows(this.rows.slice(e),-n)}}}},{key:"getMaxHeight",value:function(){return this.rows.reduce((function(t,e){return Math.max.apply(void 0,[t].concat(e.items.map((function(t){return t.top+t.height}))))}),0)}},{key:"getClosestTop",value:function(t){if(0===this.rows.length)t.top=0;else for(var e=this.rows.length-1;e>=0;e--)if(this.rows[e].top<t.top){t.top=this.rows[e].top,t.top+=this.rows[e].getOverlap(t,!1);break}return t}},{key:"getWidthAtPos",value:function(t){var e=t.left,n=t.top,i=0,o=1/0;return this.rows.forEach((function(t){if(t.top>=n)return!1;t.items.forEach((function(t){t.top+t.height>n&&(t.left<e?i=Math.max(i,t.left+t.width):o=Math.min(o,t.left))}))})),{left:i,width:o-i}}}])&&h(e.prototype,n),i&&h(e,i),t}();function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n(3),n(4);function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v=function(){function t(e,n,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=e,this.top=n,this.width=i,this.height=o,this.row=null}var e,n,i;return e=t,(n=[{key:"doesOverlap",value:function(t){return!(this.left+this.width<=t.left||t.left+t.width<=this.left||this.top+this.height<=t.top||t.top+t.height<=this.top)}}])&&d(e.prototype,n),i&&d(e,i),t}();n(18),n(19);function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var x=function(){function t(e){var n=e.width,i=void 0===n?768:n,o=e.rowHeight,r=void 0===o?15:o,a=e.numColumns,s=void 0===a?60:a,u=e.buffer,l=void 0===u?4:u,f=e.minHeight,c=void 0===f?4:f,h=e.minWidth,p=void 0===h?10:h;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=i,this.numColumns=s,this.buffer=l,this.rowHeight=r,this.minHeight=c,this.minWidth=p,this.colWidth=(i-(s-1)*l)/s+l}var e,n,i;return e=t,(n=[{key:"px2layout",value:function(t){var e=t.left,n=t.top,i=t.width,o=t.height,r=this.px2pos({left:e,top:n}),a=Math.ceil((this.left2px(r.left)+i)/this.colWidth),s=Math.ceil((this.top2px(r.top)+o+this.buffer)/this.rowHeight);return{left:r.left,top:r.top,width:a-r.left,height:s-r.top}}},{key:"layout2px",value:function(t){var e=t.left,n=t.top,i=t.width,o=t.height;return{left:this.left2px(e),top:this.top2px(n),width:this.width2px(i),height:this.height2px(o)}}},{key:"px2pos",value:function(t){var e=t.left,n=t.top;return{left:this._closestMultiple(e,this.colWidth),top:this._closestMultiple(n,this.rowHeight)}}},{key:"left2px",value:function(t){return t*this.colWidth}},{key:"top2px",value:function(t){return t*this.rowHeight}},{key:"width2px",value:function(t){return t*this.colWidth-this.buffer}},{key:"height2px",value:function(t){return t*this.rowHeight-this.buffer}},{key:"getClosestPosition",value:function(t){return this.checkPositionConstraints(this.px2layout(t))}},{key:"getClosestSize",value:function(t,e){return this.checkSizeConstraints(this.px2layout(t),e)}},{key:"checkPositionConstraints",value:function(t){var e=t.width,n=t.height,i=t.left,o=t.top;return i+e>this.numColumns&&(i=this.numColumns-e),i<0&&(i=0),o<0&&(o=0),{left:i,top:o,width:e,height:n}}},{key:"checkSizeConstraints",value:function(t,e){var n=t.width,i=t.height,o=t.left,r=t.top;return o+n>this.numColumns&&(n=this.numColumns-o),o<0&&(n=o+n-(o=0)),n<this.minWidth&&(e&&(o-=this.minWidth-n),n=this.minWidth),i<this.minHeight&&(i=this.minHeight),{left:o,top:r,width:n,height:i}}},{key:"_closestMultiple",value:function(t,e){var n=t/e,i=Math.floor(n),o=Math.ceil(n);return n-i>o-n?o:i}}])&&b(e.prototype,n),i&&b(e,i),t}();n(7),e.default=o.a.module("float",[]).directive("flContainer",(function(){return{restrict:"A",bindToController:{options:"=flContainer",isEditable:"=flEditable",createElementsAtPosition:"&flCreateElementsAtPosition"},controllerAs:"flContainer",controller:["Mapper","$element","$document","$scope","$timeout",function(){function t(e,n,i,o,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.flItems=[],this.Mapper=e,this.$element=n,this.$document=i,this.$scope=o,this.$timeout=r}var e,n,i;return e=t,(n=[{key:"$onInit",value:function(){var t=this;this.mapper=new this.Mapper(this.options),this.$element.css("width",this.mapper.width),this.isTouchDevice()&&this.$element.addClass("fl-touch"),this.isEditable&&(this.setupDropListeners(),this.setupVisitListeners(this.$document,this.$scope)),this.$timeout((function(){t.container||0!==t.flItems.length||(t.container=new p,t.render())}),500)}},{key:"initItem",value:function(t){var e=this;this.flItems.push(t),this.container?(this.container.addItem(t.item),this.render()):t.lastRepeat&&(this.container=new p(this.flItems.map((function(t){return t.item}))),this.$timeout((function(){e.render()})))}},{key:"render",value:function(){var t=this;this.container.removeGaps(),this.$element.css("height",this.mapper.height2px(this.container.getMaxHeight())+(this.isEditable?100:0)),this.flItems.forEach((function(e){return e.render(t.mapper.layout2px(e.item),{left:e.item.left,top:e.item.top,width:e.item.width,height:e.item.height})}))}},{key:"onItemEditStart",value:function(){this.$element.addClass("fl-container-editing"),this.$element.css("height",this.$element.height()+1e3)}},{key:"onItemEditEnd",value:function(t,e){this.$element.removeClass("fl-container-editing"),this.container.editItem(t,e),this.render()}},{key:"onItemRemove",value:function(t){this.flItems=this.flItems.filter((function(e){return e!==t})),this.container.removeItem(t.item),this.render()}},{key:"getNewItemDimensions",value:function(t){return this.container.getClosestTop(this.mapper.getClosestPosition(t))}},{key:"setupDropListeners",value:function(){var t=this;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1e4,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n.css({marginLeft:t,marginTop:e,width:i})}var n=angular.element("<div>").addClass("fl-drop-indicator").appendTo(this.$element);e();var i=a()((function(n){if(angular.element(n.target).is(t.$element)){var i=t.mapper.px2pos({left:n.offsetX,top:n.offsetY}),o=Object.assign(i,t.container.getWidthAtPos(i));if(o.height=t.mapper.minHeight,o.width=Math.min(o.width,t.mapper.numColumns-o.left),o.width<t.mapper.minWidth)e();else{var r=t.mapper.layout2px(t.mapper.checkPositionConstraints(o));e(r.left,r.top,r.width)}}else e()}),50);this.$element.on("dragover",(function(t){t.preventDefault(),t.stopPropagation(),i(t)})),this.$element.on("dragleave",(function(t){t.preventDefault(),t.stopPropagation(),i.cancel(),e()})),this.$element.on("drop",(function(n){if(n.preventDefault(),n.stopPropagation(),i.cancel(),e(),angular.element(n.target).is(t.$element)){var o=t.mapper.px2pos({left:n.offsetX,top:n.offsetY}),r=Object.assign(o,t.container.getWidthAtPos(o));if(r.height=t.mapper.minHeight,r.width>=t.mapper.minWidth){r.width=Math.min(r.width,t.mapper.numColumns-r.left);var a=t.mapper.checkPositionConstraints(r);t.createElementsAtPosition({event:n,dimensions:a})}}}))}},{key:"setupVisitListeners",value:function(t,e){function n(t){var e=angular.element(t.target).closest("[fl-item]").eq(0);e&&e.addClass("fl-item-selected"),angular.element("[fl-item]").not(e).removeClass("fl-item-selected")}t.on("click",n),e.$on("$destroy",(function(){t.off("click",n)}))}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}}])&&m(e.prototype,n),i&&m(e,i),t}()]}})).directive("flItem",(function(){return{restrict:"A",require:["^flContainer","flItem"],bindToController:{layout:"=flItem",resizable:"=flResizable",getHeight:"=flGetHeight",lastRepeat:"=flLastRepeat",isEditable:"=flEditable"},controllerAs:"flItem",controller:["$element",function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$element=e}var e,n,i;return e=t,(n=[{key:"$onInit",value:function(){this.item=new v(this.layout.left,this.layout.top,this.layout.width,this.layout.height)}},{key:"render",value:function(t,e){this.$element.css(t),Object.assign(this.layout,e)}}])&&w(e.prototype,n),i&&w(e,i),t}()],link:function(t,e,n,i){var o=g(i,2),r=o[0],a=o[1],s=a.resizable;function u(){e.resizable("option","handles",1===s?"e, w":"e, se, s, sw, w")}function l(t,n){if(a.getHeight){var i=r.mapper.layout2px(t),o=a.getHeight(e,i.width,n);if(o>0&&(s<2||o>i.height))return i.height=o,r.mapper.px2layout(i)}return t}r.initItem(a),e.addClass("fl-item"),r.isEditable&&(e.addClass("fl-edit"),t.$on("$destroy",(function(){r.onItemRemove(a)})),a.isEditable&&(!function(){var n=angular.element("<"+e[0].nodeName.toLowerCase()+">").addClass("fl-drag-indicator fl-item"),i=angular.element("<div>").addClass("fl-drag-clone");i.append(n);var o={};e.draggable({cursor:"move",cancel:"[fl-drag-cancel]",helper:function(){return i},start:function(s){o.width=e.outerWidth(),o.height=e.outerHeight(),i.css(r.mapper.layout2px(a.item)),n.css(r.mapper.layout2px(a.item)),e.children().clone().appendTo(n),r.onItemEditStart(),t.$broadcast("flDragStart",s)},drag:function(t,e){var i=r.mapper.layout2px(r.mapper.getClosestPosition(Object.assign(o,e.position)));n.css({left:i.left-e.position.left,top:i.top-e.position.top})},stop:function(e,i){n.empty(),r.onItemEditEnd(a.item,r.mapper.getClosestPosition(Object.assign(o,i.position))),t.$broadcast("flDragStop",e)}})}(),function(){if(!s)return;var n;function i(t){return l(r.mapper.getClosestSize(Object.assign(t.position,t.size),e.data("ui-resizable").axis.includes("w")),!0)}e.resizable({classes:{"ui-resizable-handle":"fl-resizable","ui-resizable-se":""},start:function(e){(n=angular.element("<div>").addClass("fl-resize-indicator fl-item")).css(r.mapper.layout2px(a.item)),n.appendTo("[fl-container]"),r.onItemEditStart(),t.$broadcast("flResizeStart",e)},resize:function(t,e){n.css(r.mapper.layout2px(i(e)))},stop:function(e,o){n.remove(),r.onItemEditEnd(a.item,i(o)),t.$broadcast("flResizeStop",e)}}),u()}(),t.$on("flItemChanged",(function(){var t=l(a.item,!1);t.height!==a.item.height&&r.onItemEditEnd(a.item,t)})),t.$on("flResizeChanged",(function(t,e){s=e,u()}))))}}})).factory("Mapper",(function(){return x}))}]);